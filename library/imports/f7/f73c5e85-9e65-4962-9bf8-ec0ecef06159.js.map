{"version":3,"sources":["assets\\game\\scripts\\UI\\Item\\GameUI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { ListenerManager } from \"../../../../frame/scripts/Manager/ListenerManager\";\r\nimport { SoundManager } from \"../../../../frame/scripts/Manager/SoundManager\";\r\nimport { SyncDataManager } from \"../../../../frame/scripts/Manager/SyncDataManager\";\r\nimport { UIHelp } from \"../../../../frame/scripts/Utils/UIHelp\";\r\nimport { CustomSyncData } from \"../../Data/CustomSyncData\";\r\nimport { EventType } from \"../../Data/EventType\";\r\nimport { EditorManager } from \"../../Manager/EditorManager\";\r\nimport Role from \"./Role\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameUI extends cc.Component {\r\n    @property(cc.Node)\r\n    private geziType: cc.Node[] = [];\r\n    @property(cc.Label)\r\n    private tigan: cc.Label = null;\r\n    @property(cc.Node)\r\n    private btn_node: cc.Node = null;\r\n    @property(cc.Prefab)\r\n    private role_prefab: cc.Prefab = null;\r\n    @property(cc.Node)\r\n    private btn_submit_disabled: cc.Node = null;\r\n    @property(cc.VideoPlayer)\r\n    private videoPlayer: cc.VideoPlayer = null;\r\n\r\n    onLoad() {\r\n        ListenerManager.on(EventType.ENTER_GAME, this.handleEnterGame, this);\r\n        ListenerManager.on(EventType.GAME_RECONNECT, this.initUI, this);\r\n        ListenerManager.on(EventType.GAME_REPLAY, this.handleEnterGame, this);\r\n        ListenerManager.on(EventType.CLICK_ROLE, this.handleClickRole, this);\r\n\r\n        //监听视频是否播放完毕\r\n        this.videoPlayer.node.on('completed', this.onVideoPlayerCompleted, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        ListenerManager.off(EventType.ENTER_GAME, this.handleEnterGame, this);\r\n        ListenerManager.off(EventType.GAME_RECONNECT, this.initUI, this);\r\n        ListenerManager.off(EventType.GAME_REPLAY, this.handleEnterGame, this);\r\n        ListenerManager.off(EventType.CLICK_ROLE, this.handleClickRole, this);\r\n    }\r\n\r\n    private handleEnterGame() {\r\n        if (!EditorManager.editorData.needEnd) {\r\n            this.node.getChildByName(\"bg\").active = false;\r\n        }\r\n        this.videoPlayer.node.active = true;\r\n        this.videoPlayer.play();\r\n        // this.initUI();\r\n    }\r\n\r\n    private onVideoPlayerCompleted() {\r\n        console.log(\"视频播放完毕\");\r\n\r\n        // cc.tween(this.videoPlayer.node).to(0.5, {opacity: 0}).call(() => {\r\n        //     this.videoPlayer.node.active = false;\r\n        // }).start();\r\n        this.captureNode.spriteFrame = this.CapturePicture();\r\n        this.captureNode.node.active = true;\r\n        this.scheduleOnce(() => {\r\n            this.videoPlayer.node.active = false;\r\n            cc.tween(this.captureNode.node).to(0.5, { opacity: 0 }).call(() => {\r\n                this.captureNode.node.active = false;\r\n            }).start();\r\n        }, 0.5);\r\n        this.initUI();\r\n    }\r\n\r\n    private initUI() {\r\n        this.geziType.forEach((item, index) => {\r\n            item.active = false;\r\n        });\r\n        this.geziType[EditorManager.editorData.geziSize].active = true;\r\n        this.showRole();\r\n        this.drawLine();\r\n    }\r\n\r\n    private showRole() {\r\n        let roleParent = this.geziType[EditorManager.editorData.geziSize].getChildByName(\"role_node\");\r\n        let rowCount = EditorManager.editorData.geziSize === 0 ? 5 : 6;\r\n        for (let i = 0; i < rowCount; i++) {\r\n            for (let j = 0; j < rowCount; j++) {\r\n                if (EditorManager.editorData.geziIconArr[i][j] != 0) {\r\n                    let roleNode = cc.instantiate(this.role_prefab);\r\n                    roleNode.parent = roleParent;\r\n                    let childrenIndex = i * rowCount + j;\r\n                    roleNode.name = \"role_\" + childrenIndex;\r\n                    let pos = this.geziType[EditorManager.editorData.geziSize].getChildByName(\"gezi\").children[childrenIndex].position;\r\n                    roleNode.position = pos;\r\n                    let role = roleNode.getComponent(Role);\r\n                    role.type = EditorManager.editorData.geziIconArr[i][j];\r\n                    role.geziIndex = childrenIndex;\r\n                    role.showInit();\r\n                }\r\n            }\r\n        }\r\n        this.scheduleOnce(() => {\r\n            this.showTigan();\r\n        }, 0.5);\r\n    }\r\n\r\n    private handleClickRole(data: any) {\r\n        if (SyncDataManager.getSyncData().customSyncData.curChooseRole == null) {\r\n            SyncDataManager.getSyncData().customSyncData.curChooseRole = data;\r\n        } else {\r\n            if (SyncDataManager.getSyncData().customSyncData.curChooseRole == data) {\r\n                SyncDataManager.getSyncData().customSyncData.curChooseRole = null;\r\n            } else {\r\n                this.UpdateLine(data);\r\n            }\r\n        }\r\n        for (let i = 0; i < this.geziType[EditorManager.editorData.geziSize].getChildByName(\"role_node\").childrenCount; i++) {\r\n            this.geziType[EditorManager.editorData.geziSize].getChildByName(\"role_node\").children[i].getComponent(Role).initRole();\r\n        }\r\n        if (SyncDataManager.getSyncData().customSyncData.curChooseRole != null) {\r\n            let roleNode = this.geziType[EditorManager.editorData.geziSize].getChildByName(\"role_node\").getChildByName(\"role_\" + SyncDataManager.getSyncData().customSyncData.curChooseRole);\r\n            roleNode.getComponent(Role).showClick();\r\n        }\r\n    }\r\n\r\n    private UpdateLine(data: any) {\r\n        let selfAnswer = [SyncDataManager.getSyncData().customSyncData.curChooseRole, data];\r\n        for (let i = 0; i < SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length; i++) {\r\n            let answer = SyncDataManager.getSyncData().customSyncData.selfAnswerArr[i];\r\n            if (answer[0] == selfAnswer[0] && answer[1] == selfAnswer[1]) {\r\n                SyncDataManager.getSyncData().customSyncData.selfAnswerArr.splice(i, 1);\r\n                SyncDataManager.getSyncData().customSyncData.curChooseRole = null;\r\n                SoundManager.playEffect(\"连线消失的音效\", false);\r\n                this.drawLine();\r\n                return;\r\n            } else if (answer[0] == selfAnswer[1] && answer[1] == selfAnswer[0]) {\r\n                SyncDataManager.getSyncData().customSyncData.selfAnswerArr.splice(i, 1);\r\n                SyncDataManager.getSyncData().customSyncData.curChooseRole = null;\r\n                SoundManager.playEffect(\"连线消失的音效\", false);\r\n                this.drawLine();\r\n                return;\r\n            }\r\n        }\r\n        SyncDataManager.getSyncData().customSyncData.selfAnswerArr.push(selfAnswer);\r\n        SyncDataManager.getSyncData().customSyncData.curChooseRole = null;\r\n        SoundManager.playEffect(\"出现连线的音效\", false);\r\n        this.drawLine();\r\n    }\r\n\r\n    private drawLine() {\r\n        this.btn_submit_disabled.active = SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length == 0;\r\n\r\n        let geziNode = this.geziType[EditorManager.editorData.geziSize]\r\n        let draw_node = geziNode.getChildByName(\"draw_node\");\r\n        draw_node.removeAllChildren();\r\n        for (let i = 0; i < SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length; i++) {\r\n            let answer = SyncDataManager.getSyncData().customSyncData.selfAnswerArr[i];\r\n            let startNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[0]);\r\n            let endNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[1]);\r\n            let startPos = startNode.position;\r\n            let endPos = endNode.position;\r\n            let lineNode = new cc.Node();\r\n            lineNode.parent = draw_node;\r\n            let graphics = lineNode.addComponent(cc.Graphics);\r\n            graphics.lineWidth = 20;\r\n            graphics.strokeColor = cc.Color.WHITE;\r\n            graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n            graphics.lineCap = cc.Graphics.LineCap.ROUND;\r\n            graphics.moveTo(startPos.x, startPos.y);\r\n            graphics.lineTo(endPos.x, endPos.y);\r\n            graphics.stroke();\r\n        }\r\n    }\r\n\r\n    private showTigan() {\r\n        this.tigan.string = EditorManager.editorData.tigan;\r\n        this.tigan.node.parent.active = EditorManager.editorData.tigan.length > 0;\r\n        this.scheduleOnce(() => {\r\n            this.showBtn();\r\n        }, 0.5);\r\n    }\r\n\r\n    private showBtn() {\r\n        this.btn_node.active = true;\r\n    }\r\n\r\n    private onClickReset() {\r\n        SyncDataManager.getSyncData().customSyncData.selfAnswerArr = [];\r\n        this.drawLine();\r\n    }\r\n\r\n\r\n    private onClickSubmit() {\r\n        UIHelp.showMask();\r\n        let selfAnswerArr = SyncDataManager.getSyncData().customSyncData.selfAnswerArr;\r\n        let answerArr = EditorManager.editorData.answerArr;\r\n        if (selfAnswerArr.length == answerArr.length) {\r\n            let isAllRight = true;\r\n            for (let i = 0; i < selfAnswerArr.length; i++) {\r\n                let answer = selfAnswerArr[i];\r\n                if (!this.isInArray(answerArr, answer)) {\r\n                    isAllRight = false;\r\n                    this.drawRedLine(selfAnswerArr[i]);\r\n                }\r\n            }\r\n            if (isAllRight) {\r\n                ListenerManager.dispatch(EventType.SUBMIT, true);\r\n                SoundManager.playEffect(\"正确音效\", false);\r\n                this.onTrueEffect();\r\n            } else {\r\n                ListenerManager.dispatch(EventType.SUBMIT, false);\r\n                SoundManager.playEffect(\"错误音效\", false);\r\n            }\r\n        } else {\r\n            ListenerManager.dispatch(EventType.SUBMIT, false);\r\n            SoundManager.playEffect(\"错误音效\", false);\r\n            for (let i = 0; i < selfAnswerArr.length; i++) {\r\n                let answer = selfAnswerArr[i];\r\n                if (!this.isInArray(answerArr, answer)) {\r\n                    this.drawRedLine(selfAnswerArr[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //判断元素是否在数组中\r\n    private isInArray(arr: any[][], value: any[]) {\r\n        //不考虑value数组中元素的顺序\r\n        for (let i = 0; i < arr.length; i++) {\r\n            if (arr[i].sort().toString() == value.sort().toString()) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private drawRedLine(answerArr: number[]) {\r\n        let geziNode = this.geziType[EditorManager.editorData.geziSize]\r\n        let draw_node = geziNode.getChildByName(\"draw_node\");\r\n        let startNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answerArr[0]);\r\n        let endNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answerArr[1]);\r\n        let startPos = startNode.position;\r\n        let endPos = endNode.position;\r\n        let lineNode = new cc.Node();\r\n        lineNode.parent = draw_node;\r\n        let graphics = lineNode.addComponent(cc.Graphics);\r\n        graphics.lineWidth = 20;\r\n        graphics.strokeColor = cc.Color.RED;\r\n        graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n        graphics.lineCap = cc.Graphics.LineCap.ROUND;\r\n        graphics.moveTo(startPos.x, startPos.y);\r\n        graphics.lineTo(endPos.x, endPos.y);\r\n        graphics.stroke();\r\n\r\n        this.scheduleOnce(() => {\r\n            this.delInArray(answerArr);\r\n            SoundManager.playEffect(\"连线消失的音效\", false);\r\n            lineNode.destroy();\r\n            this.drawLine();\r\n            UIHelp.closeMask();\r\n        }, 0.5);\r\n    }\r\n\r\n    private delInArray(value: any[]) {\r\n        //不考虑value数组中元素的顺序\r\n        for (let i = 0; i < SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length; i++) {\r\n            if (SyncDataManager.getSyncData().customSyncData.selfAnswerArr[i].sort().toString() == value.sort().toString()) {\r\n                SyncDataManager.getSyncData().customSyncData.selfAnswerArr.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    private onTrueEffect() {\r\n        this.drawGreenLine();\r\n        this.scheduleOnce(() => {\r\n            this.moveRole();\r\n        }, 0.5);\r\n    }\r\n\r\n    private moveRole() {\r\n        let geziNode = this.geziType[EditorManager.editorData.geziSize];\r\n        for (let i = 0; i < SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length; i++) {\r\n            let answer = SyncDataManager.getSyncData().customSyncData.selfAnswerArr[i];\r\n            let startNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[0]);\r\n            let endNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[1]);\r\n            let index1 = startNode.getComponent(Role).type;\r\n            let index2 = endNode.getComponent(Role).type;\r\n            let startRole = startNode;\r\n            let endRole = endNode;\r\n            if (index1 > index2) {\r\n                startRole = endNode;\r\n                endRole = startNode;\r\n            }\r\n\r\n            cc.tween(startRole).to(0.5, { position: endRole.position }).call(() => {\r\n                endRole.getComponent(Role).showChange();\r\n                startRole.opacity = 0;\r\n                this.scheduleOnce(() => {\r\n                    this.gameOver();\r\n                }, 2.5);\r\n            }).start();\r\n        }\r\n    }\r\n\r\n    private drawGreenLine() {\r\n        let geziNode = this.geziType[EditorManager.editorData.geziSize]\r\n        let draw_node = geziNode.getChildByName(\"draw_node\");\r\n        draw_node.removeAllChildren();\r\n        for (let i = 0; i < SyncDataManager.getSyncData().customSyncData.selfAnswerArr.length; i++) {\r\n            let answer = SyncDataManager.getSyncData().customSyncData.selfAnswerArr[i];\r\n            let startNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[0]);\r\n            let endNode = geziNode.getChildByName(\"role_node\").getChildByName(\"role_\" + answer[1]);\r\n            let startPos = startNode.position;\r\n            let endPos = endNode.position;\r\n            let lineNode = new cc.Node();\r\n            lineNode.parent = draw_node;\r\n            let graphics = lineNode.addComponent(cc.Graphics);\r\n            graphics.lineWidth = 20;\r\n            graphics.strokeColor = cc.Color.GREEN;\r\n            graphics.lineJoin = cc.Graphics.LineJoin.ROUND;\r\n            graphics.lineCap = cc.Graphics.LineCap.ROUND;\r\n            graphics.moveTo(startPos.x, startPos.y);\r\n            graphics.lineTo(endPos.x, endPos.y);\r\n            graphics.stroke();\r\n            this.scheduleOnce(() => {\r\n                lineNode.destroy();\r\n            }, 0.5);\r\n        }\r\n    }\r\n\r\n    private gameOver() {\r\n        if (EditorManager.editorData.needEnd) {\r\n            ListenerManager.dispatch(EventType.GAME_OVER);\r\n        }\r\n    }\r\n\r\n    @property(cc.Sprite)\r\n    captureNode: cc.Sprite = null;\r\n    @property(cc.Camera)\r\n    private camera: cc.Camera = null;\r\n    @property(cc.Node)\r\n    private mm: cc.Node = null;\r\n\r\n    public CapturePicture() {\r\n        let data = this.captureTexture();\r\n        let texture = new cc.Texture2D()\r\n        texture.initWithData(data, cc.Texture2D.PixelFormat.RGBA8888, 2048, 1152);\r\n        let newSpriteFrame = new cc.SpriteFrame(texture);\r\n        newSpriteFrame.setFlipY(true);\r\n        return newSpriteFrame;\r\n    }\r\n    private captureTexture() {\r\n        this.mm.active = true;\r\n        let data = this.captureScreen(this.camera.getComponent(cc.Camera), this.mm);\r\n        this.mm.active = false;\r\n        return data;\r\n    }\r\n    private captureScreen(camera: cc.Camera, prop?: cc.Node | cc.Rect) {\r\n        let newTexture = new cc.RenderTexture();\r\n        let oldTexture = camera.targetTexture;\r\n        let rect: cc.Rect = cc.rect(0, 0, cc.visibleRect.width, cc.visibleRect.height);\r\n        if (prop) {\r\n            if (prop instanceof cc.Node) {\r\n                rect = prop.getBoundingBoxToWorld();\r\n            } else {\r\n                rect = prop;\r\n            }\r\n        }\r\n        rect.width = Math.ceil(rect.width);//特殊情况下数值是浮点类型的，转换成integer类型。这里width=2048;height=1152 直接写死数值也可以\r\n        rect.height = Math.ceil(rect.height);\r\n        newTexture.initWithSize(cc.visibleRect.width, cc.visibleRect.height, cc.game._renderContext.STENCIL_INDEX8);\r\n        camera.targetTexture = newTexture;\r\n        camera.render();\r\n        camera.targetTexture = oldTexture;\r\n        let buffer = new ArrayBuffer(rect.width * rect.height * 4);\r\n        let data = new Uint8Array(buffer);\r\n        newTexture.readPixels(data, rect.x, rect.y, rect.width, rect.height);\r\n        return data;\r\n    }\r\n\r\n}\r\n"]}